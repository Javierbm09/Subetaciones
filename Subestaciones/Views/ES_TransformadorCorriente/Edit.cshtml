@model Subestaciones.Models.ES_TransformadorCorriente

@{
    ViewBag.Title = "Transformador de corriente";
}

@*@section pagetitle{
        <div class="page-title">
            <h1>Insertar transformador de corriente</h1>
        </div>
    }*@
<link href="@Url.Content("~/Content/plugins/sweetalert/sweetalert.css")" rel="stylesheet" />

<!-- END PAGE HEAD-->
<!-- BEGIN PAGE CONTENT BODY -->
<div class="page-content">
    <div class="container-fluid">
        <!-- BEGIN PAGE BREADCRUMBS -->
        <ul class="page-breadcrumb breadcrumb">
            <li>
                <a href="@Url.Action("Index","ES_TransformadorCorriente")">Transformadores de corriente </a>
                <i class="fa fa-circle"></i>
            </li>
            <li>
                <span>Editar</span>
            </li>
        </ul>
        <!-- END PAGE BREADCRUMBS -->
        <!-- BEGIN PAGE CONTENT INNER -->
        <div class="page-content-inner">
            <div class="row">
                <div class="col-md-12">

                    <div class="portlet box blue">
                        <div class="portlet-title">
                            <div class="caption">
                                <i class="fa fa-gift"></i>Editar transformador de corriente
                            </div>
                        </div>
                        <div class="portlet-body form">
                            @using (Html.BeginForm())
                            {
                                @Html.AntiForgeryToken()


                                @Html.ValidationSummary(true, "", new { @class = "text-danger" })
                                @*@Html.HiddenFor(m => m.Nro_Serie)*@
                                @Html.Hidden("NoSerieAnt", Model.Nro_Serie)
                                @Html.Hidden("FaseAnt", Model.Fase)
                                <!-- BEGIN FORM-->

                                <div class="horizontal-form">
                                    <div class="form-body">
                                        <div class="row" style="display:none">
                                            @Html.ValidationMessageFor(model => model.CodSub, "", new { @class = "text-danger" })
                                            @Html.ValidationMessageFor(model => model.Fase, "", new { @class = "text-danger" })
                                            @Html.ValidationMessageFor(model => model.Tipo_Equipo_Primario, "", new { @class = "text-danger" })
                                            @Html.ValidationMessageFor(model => model.Elemento_Electrico, "", new { @class = "text-danger" })
                                            @Html.ValidationMessageFor(model => model.Nro_Serie, "", new { @class = "text-danger" })
                                            @Html.ValidationMessageFor(model => model.Cant_Devanado, "", new { @class = "text-danger" })
                                            @Html.ValidationMessageFor(model => model.AnnoFab, "", new { @class = "text-danger" })


                                        </div>

                                        <div class="row">

                                            <div class="col-md-4">
                                                <div class="form-group">
                                                    @Html.LabelFor(model => model.CodSub, htmlAttributes: new { @class = "control-label" })
                                                    @Html.DropDownListFor(model => model.CodSub, ViewBag.CodigoSub as SelectList, "Seleccione un elemento de la lista", htmlAttributes: new { @class = "form-control select2" })
                                                </div>
                                            </div>

                                            <div class="col-md-4">

                                                <div class="form-group">
                                                    @Html.LabelFor(model => model.Tipo_Equipo_Primario, htmlAttributes: new { @class = "control-label" })
                                                    @* @Html.DropDownList("Tipo_Equipo_Primario", null, "", htmlAttributes: new { @class = "select2_single form-control" })*@
                                                    @Html.DropDownListFor(model => model.Tipo_Equipo_Primario, ViewBag.TequipoProt as SelectList,
"Seleccione un elemento de la lista", htmlAttributes: new { @class = "form-control select2" })
                                                    @*      @Html.ValidationMessageFor(model => model.Tipo_Equipo_Primario, "", new { @class = "text-danger" })*@
                                                </div>
                                            </div>

                                            <div class="col-md-4">

                                                <div class="form-group" id="cargarEquipo">
                                                    @Html.LabelFor(model => model.Elemento_Electrico)
                                                    @*@Html.EditorFor(model => model.Elemento_Electrico, new { htmlAttributes = new { @class = "form-control" } })*@
                                                    @Html.DropDownListFor(model => model.Elemento_Electrico, null,
"Seleccione un elemento de la lista", htmlAttributes: new { @class = "form-control select2" })
                                                </div>

                                            </div>
                                        </div>


                                        <div class="row">
                                            <div class="col-md-4">
                                                <div class="form-group">
                                                    @Html.LabelFor(model => model.Nro_Serie, htmlAttributes: new { @class = "control-label" })
                                                    @Html.EditorFor(model => model.Nro_Serie, new { htmlAttributes = new { @class = "form-control" } })
                                                    @*@Html.ValidationMessageFor(model => model.Nro_Serie, "", new { @class = "text-danger" })*@
                                                </div>
                                            </div>
                                            <div class="col-md-4">
                                                <div class="form-group">
                                                    @Html.LabelFor(model => model.Fase, htmlAttributes: new { @class = "control-label" })
                                                    @Html.DropDownListFor(model => model.Fase, ViewBag.Fases as SelectList,
"Seleccione un elemento de la lista", htmlAttributes: new { @class = "form-control select2" })
                                                    @*  @Html.ValidationMessageFor(model => model.Fase, "", new { @class = "text-danger" })*@
                                                </div>
                                            </div>
                                            <div class="col-md-4">
                                                <div class="form-group">
                                                    @Html.LabelFor(model => model.Fabricante, htmlAttributes: new { @class = "control-label" })
                                                    @Html.EditorFor(model => model.Fabricante, new { htmlAttributes = new { @class = "form-control" } })
                                                    @Html.ValidationMessageFor(model => model.Fabricante, "", new { @class = "text-danger" })
                                                </div>
                                            </div>
                                        </div>

                                        <div class="row">
                                            <div class="col-md-4">
                                                <div class="form-group">
                                                    @Html.LabelFor(model => model.Tipo, htmlAttributes: new { @class = "control-label" })
                                                    @Html.EditorFor(model => model.Tipo, new { htmlAttributes = new { @class = "form-control" } })
                                                    @Html.ValidationMessageFor(model => model.Tipo, "", new { @class = "text-danger" })
                                                </div>
                                            </div>
                                            <div class="col-md-4">
                                                <div class="form-group">
                                                    @Html.LabelFor(model => model.id_Voltaje_Nominal, htmlAttributes: new { @class = "control-label" })
                                                    @Html.DropDownListFor(model => model.id_Voltaje_Nominal, ViewBag.Id_Voltaje as SelectList,
"Seleccione un elemento de la lista", htmlAttributes: new { @class = "form-control select2" })
                                                    @Html.ValidationMessageFor(model => model.id_Voltaje_Nominal, "", new { @class = "text-danger" })
                                                </div>
                                            </div>
                                            <div class="col-md-4">
                                                <div class="form-group">
                                                    @Html.LabelFor(model => model.Inventario, htmlAttributes: new { @class = "control-label" })
                                                    @Html.EditorFor(model => model.Inventario, new { htmlAttributes = new { @class = "form-control" } })
                                                    @Html.ValidationMessageFor(model => model.Inventario, "", new { @class = "text-danger" })
                                                </div>
                                            </div>
                                        </div>

                                        <div class="row">
                                            <div class="col-md-4">
                                                <div class="form-group">
                                                    @Html.LabelFor(model => model.InPrimaria, htmlAttributes: new { @class = "control-label" })
                                                    @Html.EditorFor(model => model.InPrimaria, new { htmlAttributes = new { @class = "form-control" } })
                                                    @Html.ValidationMessageFor(model => model.InPrimaria, "", new { @class = "text-danger" })
                                                </div>
                                            </div>
                                            <div class="col-md-4">
                                                <div class="form-group">
                                                    @Html.LabelFor(model => model.InTrabajoPrim, htmlAttributes: new { @class = "control-label" })
                                                    @Html.EditorFor(model => model.InTrabajoPrim, new { htmlAttributes = new { @class = "form-control" } })
                                                    @Html.ValidationMessageFor(model => model.InTrabajoPrim, "", new { @class = "text-danger" })
                                                </div>
                                            </div>
                                            <div class="col-md-4">
                                                <div class="form-group">
                                                    @Html.LabelFor(model => model.InSecundaria, htmlAttributes: new { @class = "control-label" })
                                                    @Html.EditorFor(model => model.InSecundaria, new { htmlAttributes = new { @class = "form-control" } })
                                                    @Html.ValidationMessageFor(model => model.InSecundaria, "", new { @class = "text-danger" })
                                                </div>
                                            </div>
                                        </div>

                                        <div class="row">
                                            <div class="col-md-4">
                                                <div class="form-group">
                                                    @Html.LabelFor(model => model.Cant_Devanado, htmlAttributes: new { @class = "control-label" })
                                                    @Html.DropDownListFor(model => model.Cant_Devanado, ViewBag.devanados as SelectList,
"", htmlAttributes: new { @class = "form-control select2" })
                                                    @* @Html.EditorFor(model => model.Cant_Devanado, new { htmlAttributes = new { @class = "form-control" } })*@
                                                </div>
                                            </div>
                                            <div class="col-md-4">
                                                <div class="form-group">
                                                    @Html.LabelFor(model => model.AnnoFab, htmlAttributes: new { @class = "control-label" })
                                                    @Html.EditorFor(model => model.AnnoFab, new { htmlAttributes = new { @class = "form-control", type = "number", MaxLengthAttributeAdapter = 4 } })
                                                </div>
                                            </div>
                                            <div class="col-md-4">
                                                <div class="form-group">
                                                    @Html.LabelFor(model => model.FechaInstalado, htmlAttributes: new { @class = "control-label" })
                                                    @Html.EditorFor(model => model.FechaInstalado, new { htmlAttributes = new { @class = "form-control datepicker" } })
                                                    @Html.ValidationMessageFor(model => model.FechaInstalado, "", new { @class = "text-danger" })
                                                </div>
                                            </div>
                                        </div>

                                        <div class="row">
                                            <div class="col-md-4">
                                                <div class="form-group">
                                                    @Html.LabelFor(model => model.Peso, htmlAttributes: new { @class = "control-label" })
                                                    @Html.EditorFor(model => model.Peso, new { htmlAttributes = new { @class = "form-control" } })
                                                    @Html.ValidationMessageFor(model => model.Peso, "", new { @class = "text-danger" })
                                                </div>
                                            </div>
                                            <div class="col-md-4">
                                                <div class="form-group">
                                                    @Html.LabelFor(model => model.Frecuencia, htmlAttributes: new { @class = "control-label" })
                                                    @Html.DropDownListFor(model => model.Frecuencia, ViewBag.Frecuencia as SelectList,
"Seleccione un elemento de la lista", htmlAttributes: new { @class = "form-control select2" })
                                                    @Html.ValidationMessageFor(model => model.Frecuencia, "", new { @class = "text-danger" })
                                                </div>
                                            </div>
                                        </div>

                                        <div class="row">
                                            <!-- BEGIN Portlet PORTLET DATOS Devanados-->
                                            <div class="portlet light">
                                                <div class="portlet-title">
                                                    <div class="caption">
                                                        <span class="caption-subject bold"> Clase y capacidad por devanado</span>
                                                    </div>
                                                </div>
                                                <div class="portlet-body">
                                                    <div id="bootstrap_alerts_Devanados"> </div>
                                                    <div id="TablaDevanado"></div>
                                                    <div id="popEditaDevanados">
                                                        <div>Editar devanado</div>
                                                        <div style="overflow: hidden;">
                                                            <table>
                                                                <tr hidden>
                                                                    <td hidden><input id="_Nro_Serie" /></td>
                                                                </tr>

                                                                <tr>
                                                                    <td align="right">Número:</td>
                                                                    <td><input id="_Nro_Dev" readonly /></td>
                                                                </tr>
                                                                <tr>
                                                                    <td align="right">Designación:</td>
                                                                    <td><input id="_Designacion" /></td>
                                                                </tr>
                                                                <tr>
                                                                    <td align="right">Clase Precisión:</td>
                                                                    <td><input id="_clase" /></td>
                                                                </tr>
                                                                <tr>
                                                                    <td align="right">Capacidad (VA):</td>
                                                                    <td><input id="_capacidad" /></td>
                                                                </tr>
                                                                <tr>
                                                                    <td align="right"></td>
                                                                    <td style="padding-top: 10px;" align="right"><input style="margin-right: 5px;" type="button" id="SaveDev" value="Guardar" /><input id="CancelDev" type="button" value="Cancelar" /></td>
                                                                </tr>
                                                            </table>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <!-- END Portlet PORTLET Devanados-->
                                        </div>
                                        <div class="form-actions right">
                                            <a class="btn btn-primary" href="@Url.Action("Index","ES_TransformadorCorriente")"><i class="fa fa-list"></i> Listado de transformadores de corriente</a>
                                            <button type="submit" class="btn btn-success"><i class="fa fa-check"></i> Guardar </button>
                                        </div>
                                    </div>
                                </div>

                            }
                            <!-- END FORM-->
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- END PAGE CONTENT INNER -->
    </div>
</div>
<!-- END PAGE CONTENT BODY -->
<!-- END CONTENT BODY -->
@section styles{
    <link href="~/Scripts/assets/global/plugins/select2/css/select2.min.css" rel="stylesheet" type="text/css" />
    <link href="~/Scripts/assets/global/plugins/select2/css/select2-bootstrap.min.css" rel="stylesheet" type="text/css" />

    <link href="~/Scripts/assets/global/plugins/datatables/datatables.min.css" rel="stylesheet" type="text/css" />
    <link href="~/Scripts/assets/global/plugins/datatables/plugins/bootstrap/datatables.bootstrap.css" rel="stylesheet" type="text/css" />

    <link href="~/Scripts/assets/global/plugins/jstree/dist/themes/default/style.min.css" rel="stylesheet" type="text/css" />

    <!-- BEGIN PAGE LEVEL daterangepicker -->
    <link href="~/Scripts/assets/global/plugins/bootstrap-daterangepicker/daterangepicker.min.css" rel="stylesheet" type="text/css" />
    <link href="~/Scripts/assets/global/plugins/bootstrap-datepicker/css/bootstrap-datepicker3.min.css" rel="stylesheet" type="text/css" />
    <link href="~/Scripts/assets/global/plugins/bootstrap-timepicker/css/bootstrap-timepicker.min.css" rel="stylesheet" type="text/css" />
    <link href="~/Scripts/assets/global/plugins/bootstrap-datetimepicker/css/bootstrap-datetimepicker.min.css" rel="stylesheet" type="text/css" />
    <link href="~/Scripts/assets/global/plugins/clockface/css/clockface.css" rel="stylesheet" type="text/css" />
    <!-- END PAGE LEVEL daterangepicker -->

    <link href="~/Scripts/assets/plugins/jqwidgets/styles/jqx.base.css" rel="stylesheet" type="text/css" />
    <link href="~/Scripts/assets/plugins/jqwidgets/styles/jqx.orange.css" rel="stylesheet" type="text/css" />
    <link href="~/Scripts/assets/plugins/jqwidgets/styles/jqx.energyblue.css" rel="stylesheet" type="text/css" />
    <link href="~/Scripts/assets/plugins/jqwidgets/styles/jqx.windowsphone.css" rel="stylesheet" type="text/css" />
    <link href="~/Scripts/assets/plugins/jqwidgets/styles/jqx.highcontrast.css" rel="stylesheet" type="text/css" />
    <link href="~/Scripts/assets/plugins/jqwidgets/styles/jqx.light.css" rel="stylesheet" type="text/css" />

    <link href="~/Content/EstiloTabla/tablaStyle.css" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" href="~/Scripts/assets/plugins/jqwidgets/styles/jqx.base.css" type="text/css" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1 maximum-scale=1 minimum-scale=1" />

    <link href="~/Content/EstiloTabla/tablaStyle.css" rel="stylesheet" type="text/css" />

    <link href="@Url.Content("~/Content/plugins/sweetalert/sweetalert.css")" rel="stylesheet" />


}

@section script{
    <script src="~/Scripts/assets/global/scripts/datatable.js" type="text/javascript"></script>
    <script src="~/Scripts/assets/global/plugins/datatables/datatables.min.js" type="text/javascript"></script>
    <script src="~/Scripts/assets/global/plugins/datatables/plugins/bootstrap/datatables.bootstrap.js" type="text/javascript"></script>
    <script src="~/Scripts/assets/pages/scripts/table-datatables-responsive.min.js" type="text/javascript"></script>

    <script src="@Url.Content("~/Scripts/TooltipValidator1Anidacion.js")"></script>
    <script src="@Url.Content("~/Content/plugins/sweetalert/sweetalert.min.js")"></script>


    <script src="~/Scripts/assets/global/plugins/moment.min.js" type="text/javascript"></script>
    <script src="~/Scripts/assets/global/plugins/bootstrap-daterangepicker/daterangepicker.min.js" type="text/javascript"></script>
    <script src="~/Scripts/assets/global/plugins/bootstrap-datepicker/js/bootstrap-datepicker.min.js" type="text/javascript"></script>
    <script src="~/Scripts/assets/global/plugins/bootstrap-timepicker/js/bootstrap-timepicker.min.js" type="text/javascript"></script>
    <script src="~/Scripts/assets/global/plugins/bootstrap-datetimepicker/js/bootstrap-datetimepicker.min.js" type="text/javascript"></script>
    <script src="~/Scripts/assets/global/plugins/clockface/js/clockface.js" type="text/javascript"></script>

    <script src="~/Scripts/assets/pages/scripts/components-date-time-pickers.min.js" type="text/javascript"></script>

    <script src="~/Scripts/assets/global/plugins/select2/js/select2.full.js" type="text/javascript"></script>
    <script src="~/Scripts/assets/pages/scripts/components-select2.min.js" type="text/javascript"></script>
    <script src="~/Scripts/assets/global/plugins/bootstrap-switch/js/bootstrap-switch.min.js" type="text/javascript"></script>
    <script src="~/Scripts/assets/pages/scripts/components-bootstrap-switch.min.js" type="text/javascript"></script>

    <script src="~/Scripts/assets/plugins/jqwidgets/jqxcore.js" type="text/javascript"></script>
    <script src="~/Scripts/assets/plugins/jqwidgets/jqxdata.js" type="text/javascript"></script>
    <script src="~/Scripts/assets/plugins/jqwidgets/jqxbuttons.js" type="text/javascript"></script>
    <script src="~/Scripts/assets/plugins/jqwidgets/jqxscrollbar.js" type="text/javascript"></script>
    <script src="~/Scripts/assets/plugins/jqwidgets/jqxmenu.js" type="text/javascript"></script>
    <script src="~/Scripts/assets/plugins/jqwidgets/jqxwindow.js" type="text/javascript"></script>
    <script src="~/Scripts/assets/plugins/jqwidgets/jqxgrid.js" type="text/javascript"></script>
    <script src="~/Scripts/assets/plugins/jqwidgets/jqxgrid.edit.js" type="text/javascript"></script>
    <script src="~/Scripts/assets/plugins/jqwidgets/jqxpanel.js" type="text/javascript"></script>

    <script src="~/Scripts/assets/plugins/jqwidgets/jqxgrid.selection.js" type="text/javascript"></script>
    <script src="~/Scripts/assets/plugins/jqwidgets/jqxgrid.aggregates.js" type="text/javascript"></script>
    <script src="~/Scripts/assets/plugins/jqwidgets/jqxdata.export.js" type="text/javascript"></script>
    <script src="~/Scripts/assets/plugins/jqwidgets/jqxgrid.export.js" type="text/javascript"></script>
    <script src="~/Scripts/assets/plugins/jqwidgets/jqxgrid.grouping.js" type="text/javascript"></script>
    <script src="~/Scripts/assets/plugins/jqwidgets/jqxgrid.pager.js" type="text/javascript"></script>
    <script src="~/Scripts/assets/plugins/jqwidgets/jqxdropdownlist.js" type="text/javascript"></script>
    <script src="~/Scripts/assets/plugins/jqwidgets/jqxlistbox.js" type="text/javascript"></script>
    <script src="~/Scripts/assets/plugins/jqwidgets/jqxgrid.sort.js" type="text/javascript"></script>
    <script src="~/Scripts/assets/plugins/jqwidgets/jqxgrid.columnsresize.js" type="text/javascript"></script>
    <script src="~/Scripts/assets/plugins/jqwidgets/jqxgrid.filter.js" type="text/javascript"></script>
    <script src="~/Scripts/assets/plugins/jqwidgets/localization.js" type="text/javascript"></script>
    <script src="~/Scripts/assets/plugins/jqwidgets/jqxnumberinput.js" type="text/javascript"></script>
    <script src="~/Scripts/assets/plugins/jqwidgets/jqxcombobox.js" type="text/javascript"></script>
    <script src="~/Scripts/assets/plugins/jqwidgets/jqxinput.js" type="text/javascript"></script>
    <script src="~/Scripts/assets/plugins/jqwidgets/jqxcheckbox.js" type="text/javascript"></script>

    <script>
        var TC = $("#Nro_Serie").val();

        $(document).ready(function () {
            var cantDevInicial = $("#Cant_Devanado").val();

            inicializar_select2();

            function inicializar_select2() {
                $(".select2").select2({
                    placeholder: "Seleccione un elemento de la lista"
                });
            }


            $('.datepicker').datepicker({
                todayHighlight: true,
                todayBtn: "linked",
                language: "es",
                format: 'yyyy/mm/dd',
                autoclose: true
            });


            ////cargarDevanados/*();*/
            //var cantDev = ViewBag.cantidad;
            $("#Cant_Devanado").change(function () {
                var cantDev = $("#Cant_Devanado").val();
                if (cantDev > cantDevInicial) { AgregarDev(); }
                if (cantDev < cantDevInicial) { EliminarDev(); }
            });

            $("#FechaInstalado").datepicker({});

            $("#CodSub").change(function () {
                cargarTEquipo();
            });

            $("#Tipo_Equipo_Primario").change(function () {
                cargarTEquipo();
            });


            function cargarTEquipo() {
                var TE = $("#Tipo_Equipo_Primario").val();
                var sub = $("#CodSub").val();
                if (TE != "" && sub != "") {
                    $.ajax({
                        url: '@Url.Action("CargarEquipo", "ES_TransformadorCorriente")',
                        method: "POST",
                        data: { tipoequipo: TE, codsub: sub },
                        success: function (data) {
                            $('#cargarEquipo').html(data);
                            $(".select2_single").select2({
                                placeholder: "Seleccione un elemento de la lista",
                                allowClear: true
                            });
                        }
                    });
                }
            }
     
            function AgregarDev() {
                //var llaves = this.id;
                //var camposLlaves = llaves.split("|");
                var numDev = $("#Cant_Devanado").val();
                var idTC = $("#Nro_Serie").val();
                var baseUrl = $('base').attr('href');
                        $.ajax({
                            url: baseUrl + 'ES_TransformadorCorriente/agregarDevanado',
                            method: "POST",
                            data: { dev: numDev, devInicial: cantDevInicial, serie: idTC },
                            success: function (data) {
                                if (data) {
                                   
                                    //cargarTablaDev(idTC)
                                    $("#TablaDevanado").jqxGrid('updatebounddata');


                                } else {
                                    $("#Cant_Devanado").val(devInicial);

                                  
                                }

                            },
                            error: function (data) {
                                console.log(data);
                            }
                        });

                devInicial = numDev;
            }

            function EliminarDev() {
                //var llaves = this.id;
                //var camposLlaves = llaves.split("|");
                var numDev = $("#Cant_Devanado").val();
                var idTC = $("#Nro_Serie").val();
                var baseUrl = $('base').attr('href');

                swal({
                    title: "¿Está seguro de eliminar el devanado?",
                    text: "¡Los valores del mayor devanado se van a eliminar y no se podrán recuperar!",
                    type: "warning",
                    showCancelButton: true,
                    confirmButtonColor: "#DD6B55",
                    confirmButtonText: "¡Sí, eliminar!",
                    cancelButtonText: "¡No, cancelar!",
                    closeOnConfirm: false,
                    closeOnCancel: false
                }, function (isConfirm) {
                    if (isConfirm) {
                        $.ajax({
                            url: baseUrl + 'ES_TransformadorCorriente/EliminarDevanado',
                            method: "POST",
                            data: { dev: numDev, devInicial: cantDevInicial, serie: idTC },
                            success: function (data) {
                                if (data) {
                                    swal({
                                        title: "¡Eliminado!",
                                        text: "Se ha eliminado el devanado.",
                                        type: "success",
                                        confirmButtonText: "Cerrar",
                                        confirmButtonClass: "btn-primary"
                                    });

                                    //cargarTablaDev(idTC)
                                    $("#TablaDevanado").jqxGrid('updatebounddata');


                                } else {
                                    $("#Cant_Devanado").val(devInicial);

                                    swal({
                                        title: "¡Cancelado!",
                                        text: "¡El devanado no ha podido ser eliminado!",
                                        type: "error",
                                        confirmButtonText: "Cerrar",
                                        confirmButtonClass: "btn-primary"
                                    });
                                }

                            },
                            error: function (data) {
                                console.log(data);
                            }
                        });

                    } else {
                        swal("Cancelado", "Los datos han sido salvados", "error")
                    }
                    });
                devInicial = numDev;

            }

            /////// editar devanado
            $("#_Nro_Dev").jqxInput({ theme: 'energyblue' });
            $("#_Designacion").jqxInput({ theme: 'energyblue' });
            $("#_clase").jqxInput({ theme: 'energyblue' });
            $("#_capacidad").jqxInput({ theme: 'energyblue' });

            $("#_Nro_Dev").width(250);
            $("#_Nro_Dev").height(23);
            $("#_Designacion").width(250);
            $("#_Designacion").height(23);
            $("#_clase").width(250);
            $("#_clase").height(23);
            $("#_capacidad").width(250);
            $("#_capacidad").height(23);

            $("#popEditaDevanados").jqxWindow({
                width: 400, height: 190, resizable: false, isModal: true, autoOpen: false, cancelButton: $("#CancelDev"), modalOpacity: 0.01
            });

            $("#popEditaDevanados").on('open', function () {


            });

            $("#SaveDev").jqxButton({ theme: 'energyblue' });
            $("#CancelDev").jqxButton({ theme: 'energyblue' });

            $("#SaveDev").click(function () {
                if (editrow >= 0) {

                    var row = {
                        Nro_Dev: $("#_Nro_Dev").val(), Nro_Serie: $("#_Nro_Serie").val(), Capacidad: $("#_capacidad").val(), Clase_Precision: $("#_clase").val(), Designacion: $("#_Designacion").val(),
                    };
                    var rowID = $('#TablaDevanado').jqxGrid('getrowid', editrow);
                    $('#TablaDevanado').jqxGrid('updaterow', rowID, row);

                    $("#popEditaDevanados").jqxWindow('hide');
                }
            });
        });
    </script>
    <script src="~/Scripts/js/jsTablaDevanados.js"></script>

}
